---
title: 高阶组件的初级应用
date: 2019-07-31
categories:
  - JavaScript
tags:
  - JavaScript
  - react
---

## 高阶组件(Higher-Order Components)

高阶组件（HOC）是 React 中用于重用组件逻辑的高级技术。 HOC 本身不是 React API 的一部分。 它们是从 React 构思本质中浮现出来的一种模式。

具体来说，高阶组件是一个函数，能够接受一个组件并返回一个新的组件。

## 实现高阶组件的方法

1. 属性代理
   高阶组件通过包裹 react 组件来操作 props
2. 反向继承
   高阶组件继承于被包裹的 react 组件

## 属性代理

我们通过一个例子来说明：

```js
import React, { PureComponent } from "react";
import { Spin, message } from "antd";
import API from "./api";

const MyContainer = TargetComponnet => {
  return class extends PureComponent {
    state = {
      newProps: ""
    };

    componentDidMount() {
      this.setState({ loading: true });
      API.getConfig()
        .then(res => {
          this.setState({
            newProps: res,
            loading: false
          });
        })
        .catch(error => {
          message.error("服务异常");
          this.setState({ loading: false });
        });
    }

    render() {
      const { newProps, loading } = this.state;
      return (
        <Spin style={{ width: "100%", paddingTop: 300 }} spinning={loading}>
          <TargetComponnet newProps={newProps} {...this.props} />
        </Spin>
      );
    }
  };
};
export default MyContainer;
```

其中最重要的部分是 render 方法中返回了传入的 react 组件`TargetComponent`，同时往`TargetComponent`中传入了我们自己的`newProps`属性，这种方法即为属性代理。
使用这个高阶组件非常容易：

```js
import React, { Component } from "react";
import MyContainer from "./mycontainer";

@MyContainer
export default class MyComponent extends Component {
  //...
}
```

有时候，我们调用高阶组件的时候需要传入一些参数，这个实现非常简单，我们修改一下上面的方法：

```js
  //HOC
  const MyContainer = params => TargetComponnet => {
    return ...
  }
  //使用方法
  @MyContainer(params)
  export default class MyComponent extends Component {
    //...
  }

```

## 反向继承
